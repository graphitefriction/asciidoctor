= Section IDs and Anchors
:url-ntname: https://www.w3.org/TR/REC-xml/#NT-Name
:url-adoc-a2x: http://aerostitch.github.io/misc/asciidoc/asciidoc-title_uft8.html
// New page, content taken from sections.adoc

[#auto-id]
== Autogenerated IDs

// tag::autoid[]
If you don't specify a custom ID for a section, Asciidoctor automatically generates an ID from the section's title and assigns it to the section.

The ID is derived from the section title as follows:

* Inline formatting is applied (in title substitution order).
* All characters are converted to lowercase.
* The value of the `idprefix` attribute (`+_+` by default) is prepended.
* Character references, HTML/XML tags, and invalid ID characters are removed.
 ** Refer to the {url-ntname}[NT-Name^] section of the XML specification for a list of valid ID characters.
 ** Prior to 1.5.7, HTML/XML tags were not removed and character references and invalid ID characters were replaced with the value of the `idseparator` attribute (`+_+` by default).
* Spaces, hyphens, and periods are replaced with the value of the `idseparator` attribute (`+_+` by default)
* Repeating separator characters are condensed.
* If necessary, a sequence number is appended until the ID is unique within the document.

For example, the section title `Wiley & Sons, Inc.` produces the ID `_wiley_sons_inc`.
You can customize the replacement characters or toggle ID autogeneration using document attributes.

[#prefix]
=== Change the ID prefix

You can change the ID prefix by setting the `idprefix` attribute.
The value of the `idprefix` attribute must begin with a valid ID start character and can have any number of additional valid ID characters.

[source]
----
:idprefix: id_
----

If you want to remove the prefix, set the attribute to an empty value.

[source]
----
:idprefix:
----

WARNING: If you set the `idprefix` to blank, you could end up generating IDs that are invalid in DocBook output (e.g., an ID that begins with a number) or that match a built-in ID in the HTML output (e.g., `header`).
In this case, we recommend either using a non-empty value of `idprefix` or assigning explicit IDs to your sections.

[#separator]
=== Change the ID word separator

You can change the word separator using the `idseparator` attribute.
Unless empty, the value of the `idseparator` must be _exactly one valid ID character_.

[source]
----
:idseparator: -
----

If you don't want to use a separator, set the attribute to an empty value.

[source]
----
:idseparator:
----

NOTE: When a document is rendered on GitHub, the `idprefix` is set to an empty value and the `idseparator` is set to `-`.
These settings are used to ensure that the IDs generated by GitHub match the IDs generated by Asciidoctor.

=== Disable ID generation

To disable the autogeneration of section IDs, unset the `sectids` attribute.

[source]
----
:sectids!:
----

Custom IDs, covered next, are used even when section IDs are disabled.

WARNING: If you disable autogenerated section IDs, and you don't assign an explicit ID to a section, you won't be able to create xrefs to that section.
// end::autoid[]

== Assign custom IDs

// tag::custom-id[]
You can assign a custom ID and optional reference text (i.e., label) to a section (see xref:attributes:id.adoc#anchor[anchor]).
The custom ID is used in place of the autogenerated ID.
This can be useful when you want to define a stable anchor for linking to a section using a cross reference.
The reference text is used when referencing the ID without specifying explicit text.
This is a good way to centrally manage the automatic reference text that is used to refer to a section.

Here's an example of a section with a custom ID:

[source]
----
include::example$section.adoc[tag=with-anchor-shorthand]
----

Here's an example of a section with a custom ID and reference text:

[source]
----
include::example$section.adoc[tag=with-anchor-and-reftext]
----

The ID can be written using the following shorthand (though there's no shorthand yet for the reference text):

[source]
----
include::example$section.adoc[tag=with-anchor-and-reftext-shorthand]
----

IMPORTANT: The value of the reftext attribute must be quoted if it contains spaces or commas.

NOTE: Asciidoctor permits all valid UTF-8 characters in section IDs.
If you're generating a PDF from AsciiDoc using a2x and dblatex, see {url-adoc-a2x}[Using UTF-8 titles with a2x^] to learn about the required `latex.encoding=utf8` switch.
// end::custom-id[]

== Assign additional anchors

A section title can only have a single primary ID.
However, it's possible to register additional anchor points on a section title using inline anchors.
This feature works regardless of whether you assign a custom ID.

Here's how to register additional anchor points when using an auto-generated ID:

.Register additional leading anchor points
[source]
----
== [[secondary-id]][[tertiary-id]]Section Title
----

.Register additional trailing anchor points
[source]
----
== Section Title[[secondary-id]][[tertiary-id]]
----

You can place the anchors anywhere within the section title line.
Where you place them is where the anchor will end up in the output, so it's best to put them either at the beginning or the end.
The beginning is the preferred location.

These additional anchor points don't interfere with the declaration of the primary ID.

.Register additional leading anchor points on a section title with a custom ID
[source]
----
[#primary-id]
== [[secondary-id]][[tertiary-id]]Section Title
----

////
Alternately, you can move the primary ID inline by placing it after the section title, offset by a single space.

.Set the custom ID within the section title
[source]
----
== Section Title[[secondary-id]][[tertiary-id]] [[primary-id]]
----

However, we don't recommend defining the primary ID inline as it's more difficult to read.
////

[#link]
== Turn section titles into links

// tag::link[]
To turn section titles into links, enable the `sectlinks` attribute.
The default Asciidoctor stylesheet displays linked section titles with the same color and styles as unlinked section titles.
// end::link[]

[#anchor]
== Add &sect; to section titles

// tag::anchor[]
When the `sectanchors` attribute is enabled on a document, an anchor (empty link) is added before the section title.
The default Asciidoctor stylesheet renders the anchor as a section entity (*&sect;*) that floats to the left of the section title.
// end::anchor[]
